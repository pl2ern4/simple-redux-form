(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{209:function(t,e,n){t.exports=n(440)},229:function(t,e,n){},439:function(t,e,n){},440:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),c=n(20),o=n.n(c),i=n(103),u=n(37),s=n(14),l=n(13),m=n(105),d=n.n(m),p=n(43),h=n(171),f="https://simpleexpressapi.azurewebsites.net",E=new Headers({Accept:"application/json","Content-Type":"application/json;charset=UTF-8"});function b(t){return C.apply(this,arguments)}function C(){return(C=Object(h.a)(d.a.mark(function t(e){var n,a,r,c,o=arguments;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{"Content-Type":"application/json"},a=o.length>2&&void 0!==o[2]?o[2]:{},r=o.length>3&&void 0!==o[3]?o[3]:"GET",c=Object(l.a)({headers:n,method:r},"GET"!==r&&{body:JSON.stringify(a)}),t.next=6,new Promise(function(t,n){fetch(e,Object(l.a)({},c)).then(function(t){return t.ok?t.json():null}).then(function(e){return t(e)}).catch(function(t){return console.log("Looks like there was a problem: \n",t),null})}).then(function(t){return t});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}},t)}))).apply(this,arguments)}E.append("Access-Control-Allow-Origin",f),E.append("Access-Control-Allow-Credentials","true");var v={FETCHED_RESULT:"FETCHED_RESULT",FETCHING_RESULT:"FETCHING_RESULT",SHOW_ERROR:"SHOW_ERROR",RESULT:"RESULT",RESET_STATE:"RESET_STATE",CLEAR_ERROR:"CLEAR_ERROR"},O=function(t){return Object(l.a)({type:v.FETCHING_RESULT},t)},F=function(t){return{type:v.FETCHED_RESULT,payload:t}},y=function(t){return Object(l.a)({type:v.SHOW_ERROR},t)},g=function(t){return function(e){e(O()),function(t){return b("".concat(f,"/update"),E,t,"POST").then(function(e){return Object(p.a)({},t.key,e)})}(Object(l.a)({},t)).then(function(t){e(F(Object(l.a)({},t)))}).catch(function(t){return e(y(t))})}};function j(t){return function(e){e(O({customerList:[]})),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return b("".concat(f,"/get")+(t.id&&"?id="+t.id||"")).then(function(e){return Object(p.a)({},t.key,e)})}(t).then(function(t){e(F(Object(l.a)({},t)))}).catch(function(t){return e(y(t))})}}function S(t){return function(e){e(O()),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return b("".concat(f,"/insert"),E,t,"POST").then(function(e){return Object(p.a)({},t.key,e)})}(Object(l.a)({},t,{key:"isCreatedUser"})).then(function(t){e(F(Object(l.a)({},t)))}).catch(function(t){return e(y(t))})}}function R(t){return function(e){e(O()),function(t){return b("".concat(f,"/delete"),E,t,"DELETE").then(function(e){return Object(p.a)({},t.key,e)})}({id:t,key:"customerList"}).then(function(t){t.isCustomerDeleted&&0===t.isCustomerDeleted.ok?e(y({error:"Couldn't delete user. This might happen if user is already not found or server Error !!"})):e(F(Object(l.a)({},t,{customerContact:[]})))}).catch(function(t){return e(y(t))})}}var k={customerList:[],customerContact:[]},T=n(11),_=n(172),w=n(173),U=n(169),L=n(174),A=n(175),N=n(184),D=n(176),x=n(79),H=n(183),I=n(128),P=n(168),G=n(141),M=n(167),V=n(52),z=n.n(V),W=n(177),q=n.n(W),J=n(178),$=n(180),B=(n(227),n(228),n(229),function(t){return t||"string"===typeof t?void 0:"Required"}),Q=function(t){return t&&t.length>15?"Must be 15 characters or less":void 0},Y=function(t){return t&&t.length<2?"Must be 2 characters or more":void 0},Z=function(t){return t&&/^[a-zA-Z ]*$/.test(t)?void 0:"Must be alphabetic only"},K=function(t){return t&&!/^[0-9]+$/.test(t)?"Must be numeric only":void 0},X=function(t){return t&&t.length<8?"Must be of length 8 or more":void 0},tt=n(185),et=n(179),nt=n.n(et),at=function(t){var e=t.input,n=t.data,a=t.valueField,c=t.textField,o=t.defaultValue,i=Object(tt.a)(t,["input","data","valueField","textField","defaultValue"]);return r.a.createElement(nt.a,Object.assign({data:n,valueField:a,textField:c,onChange:e.onChange,defaultValue:o},e,i))},rt=function(t){var e=t.input,n=t.label,a=t.type,c=t.placeholder,o=t.meta,i=o.touched,u=o.error;return r.a.createElement("div",null,r.a.createElement("label",null,n),r.a.createElement("div",{className:"input"},r.a.createElement("p",{className:u&&i?"zero-button-margin":""},r.a.createElement("input",Object.assign({className:u&&i?"zero-button-margin":""},e,{placeholder:c,type:a}))),i&&u&&r.a.createElement("p",{className:"error"},r.a.createElement("span",null,u))))},ct=function(t){function e(t){var n;return Object(L.a)(this,e),(n=Object(N.a)(this,Object(D.a)(e).call(this,t))).componentState=function(){return{contactFields:[],isFieldUpdated:!1}},n.onChange=function(t){("undefined"===typeof n.props.customerContact[0]||n.props.customerContact[0]&&t.id!==n.props.customerContact[0].id)&&(n.props.destroy(),n.setState({contactFields:[],isFieldUpdated:!1},function(){n.props.getCustomer(Object(l.a)({},t,{key:"customerContact"}))}))},n.handleSubmit=function(t,e){var n=[];delete t.customerList;var a=e.contactFormFields,r=e.customerContact,c=z.a.pick(t,z.a.keys(a));Object.keys(c).forEach(function(e){z.a.isObject(t[e])&&t[e].phone&&n.push({phone:t[e].phone,isActive:t[e].isActive.value||0})}),e.submitContact({key:"customerContact",contactDetail:n,id:r[0]._id})},n.onDelete=function(t,e,a,r){var c=[],o="",i=r.customerContact[0]._id;new Promise(function(n,a){c=e.filter(function(e,n){return t!==n}),o=e.filter(function(e,n){return t===n}),n({newContactList:c,removedNumber:o})}).then(function(t){n.setState({contactFields:t.newContactList},function(){o[0].phone&&a({action:"delete",key:"customerContact",contactDetail:c.filter(function(t){return t.phone}),id:i})})})},n.createUser=function(){window.location.href="#/createnewcustomer"},n.addContact=function(){var t=n.state.contactFields||[];t.push({phone:"",isActive:0}),new Promise(function(e,a){n.setState({contactFields:t},function(t){return e()})})},n.getContactFields=function(t){var e=n.props,a=e.submitting,c=e.submitContact,o=Object(x.a)(n),i=o.onDelete,u=o.addContact,s=n.state.contactFields,l=[{value:0,text:"deactivate"},{value:1,text:"activate"}],m=s&&s.map(function(t,e){return r.a.createElement(I.a,{key:"field_".concat(e),name:"section_".concat(e)},r.a.createElement("tr",{key:"row_".concat(e)},r.a.createElement("td",{className:"table-column"},r.a.createElement(P.a,{name:"phone",component:rt,type:"text",placeholder:"Phone number",maxlength:15,validate:[B,K,X]})),r.a.createElement("td",{className:"table-column"},r.a.createElement(P.a,{name:"isActive",component:at,data:l,valueField:"value",textField:"text",defaultValue:l[0]})),r.a.createElement("td",{className:"table-column"},r.a.createElement("button",{type:"button",onClick:function(t){return i(e,s,c,n.props)}},"Delete"))))});return r.a.createElement(r.a.Fragment,null,m,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("button",{type:"button",onClick:u},"Add Number"))),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("button",{type:"submit",disabled:a},"Update"))))},n.handleErrorClick=function(){n.props.handleErrorClick(),n.props.history.push("/")},n.state=n.componentState(),n}return Object(H.a)(e,t),Object(A.a)(e,[{key:"shouldComponentUpdate",value:function(t,e){var n=t.customerContact[0]&&t.customerContact[0]._id||"";if(t.change("customerList",n),!z.a.isEqual(this.props.customerContact,t.customerContact)||!z.a.isEqual(this.state.contactFields,e.contactFields)){var a=this.props.customerContact[0]&&t.customerContact[0]&&this.props.customerContact[0].contactDetail.length>t.customerContact[0].contactDetail.length,r=t.customerContact[0]&&e.contactFields.length+1===this.state.contactFields.length,c=t.customerContact[0]&&this.props.customerContact[0]&&this.props.customerContact[0]._id==t.customerContact[0]._id,o=(r||a)&&e.contactFields||t.customerContact[0]&&t.customerContact[0].contactDetail||[];this.setState({isFieldUpdated:!1,contactFields:c&&o||t.customerContact[0]&&t.customerContact[0].contactDetail})}return!0}},{key:"componentDidMount",value:function(){this.props.getCustomer({key:"customerList"})}},{key:"componentDidUpdate",value:function(t,e){var n=this,a={},r=this.state.contactFields,c=this.props.contactFormFieldsValue;!this.state.isFieldUpdated&&r.length&&(r.forEach(function(t,e){console.log(c["section_".concat(e)],e),a["section_".concat(e,".phone")]=t.phone||c["section_".concat(e)]&&c["section_".concat(e)].phone||"",a["section_".concat(e,".isActive")]=t.isActive||c["section_".concat(e)]&&c["section_".concat(e)].isActive||0}),Object.keys(a).length&&(Object.keys(a).forEach(function(t){n.props.change(t,a[t]),n.props.untouch(t)}),this.setState({isFieldUpdated:!0})))}},{key:"render",value:function(){var t=this,e=this.props,n=e.customerList,a=e.isFetching,c=e.customerContact,o=e.handleSubmit,i=e.deleteSelectedUser,u=e.submitContact,s=e.error,l=e.isError,m=e.contactFormFields;return l&&Object(J.confirmAlert)({title:"Error",message:s||"There is an Error Sorry !!",buttons:[{label:"Ok",onClick:function(){return t.handleErrorClick("Click Yes")}}]}),r.a.createElement(q.a,{active:a,spinner:!0},r.a.createElement(G.a,{name:"add-contact",onSubmit:o(function(e){return t.handleSubmit(e,{customerContact:c,contactFormFields:m,submitContact:u})})},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement(P.a,{busy:a,busySpinner:r.a.createElement("span",{className:"fas fa-sync fa-spin"}),name:"customerList",component:at,data:n,valueField:"id",textField:"name",placeholder:"Select Customer",onChange:this.onChange}))),!!c.length&&this.getContactFields(),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("button",{type:"button",onClick:this.createUser},"Create User"))),c[0]&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("button",{type:"button",onClick:function(t){return i(c[0]._id)}},"Delete Selected User")))||null))))}}]),e}(a.Component),ot=Object(M.a)({form:"ContactForm",enableReinitialize:!0,forceUnregisterOnUnmount:!0})(ct),it=Object(s.connect)(function(t){return{customerList:t.app.customerList||[],isFetching:t.app.isFetching,customerContact:t.app.customerContact||[],error:t.app.error,isError:t.app.isError,contactFormFields:t.form.ContactForm&&t.form.ContactForm.registeredFields||{},contactFormFieldsValue:Object($.getFormValues)("ContactForm")(t)}},function(t){return{getCustomer:function(e){return t(j(e))},submitContact:function(e){return t(g(e))},deleteSelectedUser:function(e){return t(R(e))},handleErrorClick:function(e){return t(function(t){t({type:v.CLEAR_ERROR})})}}})(ot),ut=n(182),st=Object(M.a)({form:"newCustomer",enableReinitialize:!0})(function(t){var e=Object(a.useState)(!1),n=Object(ut.a)(e,2),c=n[0],o=n[1];return t.toRedirect||c?r.a.createElement(u.a,{to:"/"}):r.a.createElement(G.a,{name:"newCustomer",onSubmit:t.handleSubmit(t.createNewCustomer)},r.a.createElement("p",{className:"heading"},"Create New User"),r.a.createElement(P.a,{name:"name",component:rt,type:"text",placeholder:"Customer Name",validate:[B,Q,Y,Z]}),t.touched&&t.error&&r.a.createElement("span",null,t.error),r.a.createElement("p",null,r.a.createElement("button",{type:"Submit"},"Create Customer")),r.a.createElement("p",null,r.a.createElement("button",{type:"button",onClick:function(t){return o(!0)}},"Redirect To Customer Contact Page ")))}),lt=Object(s.connect)(function(t){return{toRedirect:t.app.isCreatedUser&&t.app.isCreatedUser.ok}},function(t){return{createNewCustomer:function(e){return t(S(e))}}})(st),mt=n(31),dt=function(t){var e=t.dispatch;return function(t){return function(n){n.type===mt.a.UNREGISTER_FIELD&&(e(Object(mt.b)(n.meta.form,n.payload.name,null)),e(Object(mt.c)(n.payload.name))),n.type===mt.a.REGISTER_FIELD&&n.payload.name.indexOf("isActive")>-1&&e(Object(mt.b)(n.meta.form,n.payload.name,0)),t(n)}}};n(439),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pt=Object(T.combineReducers)({app:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case v.FETCHING_RESULT:return Object(l.a)({},t,{isFetching:!0,isError:!1});case v.SHOW_ERROR:return Object(l.a)({},t,{isFetching:!1,isError:!0,error:e.error});case v.CLEAR_ERROR:return Object(l.a)({},t,{isError:!1,error:null});case v.FETCHED_RESULT:return Object(l.a)({},t,{isFetching:!1,isError:!1},e.payload||[]);case v.RESET_STATE:return Object(l.a)({},t,{isFetching:!1,isError:!1,status:v.QUOTE,resultQuote:{}});default:return Object(l.a)({},t)}},form:U.a}),ht=Object(_.createLogger)(),ft=Object(T.createStore)(pt,Object(T.applyMiddleware)(w.a,ht,dt)),Et=function(){return r.a.createElement("strong",null,"Sorry No Page Found")},bt=r.a.createElement(s.Provider,{store:ft},r.a.createElement(function(){return r.a.createElement(i.a,{basename:"/simple-redux-form"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/createnewcustomer",component:lt}),r.a.createElement(u.b,{path:"/",component:it}),r.a.createElement(u.b,{component:Et})))},null));o.a.render(bt,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[209,1,2]]]);
//# sourceMappingURL=main.53d3df56.chunk.js.map