(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{145:function(e,t,n){e.exports=n(303)},165:function(e,t,n){},302:function(e,t,n){},303:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(15),o=n.n(c),i=n(81),u=n(26),l=n(21),s=n(6),m=n(83),d=n.n(m),p=n(31),E=n(130),f="https://simpleexpressapi.azurewebsites.net",h=new Headers({Accept:"application/json","Content-Type":"application/json;charset=UTF-8"});function b(e){return C.apply(this,arguments)}function C(){return(C=Object(E.a)(d.a.mark(function e(t){var n,a,r,c=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.length>1&&void 0!==c[1]?c[1]:{},n=c.length>2&&void 0!==c[2]?c[2]:{},a=c.length>3&&void 0!==c[3]?c[3]:"GET",r=Object(s.a)({headers:{"Content-Type":"application/json"},method:a},"GET"!==a&&{body:JSON.stringify(n)}),e.next=6,new Promise(function(e,n){fetch(t,Object(s.a)({},r)).then(function(e){return e.ok?e.json():null}).then(function(t){return e(t)}).catch(function(e){return console.log("Looks like there was a problem: \n",e),null})}).then(function(e){return e});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}h.append("Access-Control-Allow-Origin",f),h.append("Access-Control-Allow-Credentials","true");var v={FETCHED_RESULT:"FETCHED_RESULT",FETCHING_RESULT:"FETCHING_RESULT",SHOW_ERROR:"SHOW_ERROR",RESULT:"RESULT",RESET_STATE:"RESET_STATE",CLEAR_ERROR:"CLEAR_ERROR"},O=function(e){return Object(s.a)({type:v.FETCHING_RESULT},e)},g=function(e){return{type:v.FETCHED_RESULT,payload:e}},y=function(e){return Object(s.a)({type:v.SHOW_ERROR},e)},j=function(e){return function(t){t(O()),function(e){return b("".concat(f,"/update"),h,e,"POST").then(function(t){return Object(p.a)({},e.key,t)})}(Object(s.a)({},e)).then(function(e){t(g(Object(s.a)({},e)))}).catch(function(e){return t(y(e))})}};function S(e){return function(t){t(O({customerList:[]})),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return b("".concat(f,"/get")+(e.id&&"?id="+e.id||"")).then(function(t){return Object(p.a)({},e.key,t)})}(e).then(function(e){t(g(Object(s.a)({},e)))}).catch(function(e){return t(y(e))})}}function R(e){return function(t){t(O()),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return b("".concat(f,"/insert"),"",e,"POST").then(function(t){return Object(p.a)({},e.key,t)})}(Object(s.a)({},e,{key:"isCreatedUser"})).then(function(e){t(g(Object(s.a)({},e)))}).catch(function(e){return t(y(e))})}}function F(e){return function(t){t(O()),function(e){return b("".concat(f,"/delete"),"",e,"DELETE").then(function(t){return Object(p.a)({},e.key,t)})}({id:e,key:"isCustomerDeleted"}).then(function(e){e.isCustomerDeleted&&0===e.isCustomerDeleted.ok?t(y({error:"Couldn't delete user. This might happen if user is already not found or server Error !!"})):t(g(Object(s.a)({},e,{customerContact:[]})))}).catch(function(e){return t(y(e))})}}var k={customerList:[],customerContact:[]},T=n(7),w=n(131),U=n(132),_=n(308),L=n(133),D=n(134),N=n(143),A=n(135),x=n(55),H=n(142),P=n(304),z=n(307),G=n(305),M=n(306),W=n(80),I=n.n(W),V=n(136),J=n.n(V),q=n(137),B=(n(163),n(164),n(165),function(e){return e||"string"===typeof e?void 0:"Required"}),Q=function(e){return e&&"object"===typeof e&&e.value?void 0:"Required"},$=function(e){return e&&e.length>15?"Must be 15 characters or less":void 0},Y=function(e){return e&&e.length<2?"Must be 2 characters or more":void 0},Z=function(e){return e&&/^[a-zA-Z ]*$/.test(e)?void 0:"Must be alphabetic only"},K=function(e){return e&&"NaN"===Number(e)?"Must be numeric only":void 0},X=function(e){return e&&e.length<8?"Must be of length 8 or more":void 0},ee=n(144),te=n(138),ne=n.n(te),ae=function(e){var t=e.input,n=e.data,a=e.valueField,c=e.textField,o=e.defaultValue,i=Object(ee.a)(e,["input","data","valueField","textField","defaultValue"]);return r.a.createElement(ne.a,Object.assign({data:n,valueField:a,textField:c,onChange:t.onChange,defaultValue:o},t,i))},re=function(e){var t=e.input,n=e.label,a=e.type,c=e.placeholder,o=e.meta,i=o.touched,u=o.error;return r.a.createElement("div",null,r.a.createElement("label",null,n),r.a.createElement("div",{className:"input"},r.a.createElement("p",{className:u&&i?"zero-button-margin":""},r.a.createElement("input",Object.assign({className:u&&i?"zero-button-margin":""},t,{placeholder:c,type:a}))),i&&u&&r.a.createElement("p",{className:"error"},r.a.createElement("span",null,u))))},ce=function(e){function t(e){var n;return Object(L.a)(this,t),(n=Object(N.a)(this,Object(A.a)(t).call(this,e))).componentState=function(){return{contactFields:[],isFieldUpdated:!1,customerContact:[]}},n.onChange=function(e){("undefined"===typeof n.props.customerContact[0]||n.props.customerContact[0]&&e.id!==n.props.customerContact[0].id)&&n.setState({contactFields:[],isFieldUpdated:!1},function(){return n.props.getCustomer(Object(s.a)({},e,{key:"customerContact"}))})},n.handleSubmit=function(e,t){var n=[];delete e.customerList,Object.keys(e).forEach(function(t){I.a.isObject(e[t])&&n.push({phone:e[t].phone,isActive:e[t].isActive.value})}),t.submitContact({key:"customerContact",contactDetail:n,id:t.customerContact[0]._id})},n.onDelete=function(e,t,a){var r=[];new Promise(function(n,a){n(r=t[0].contactDetail&&t[0].contactDetail.filter(function(t,n){return e!==n}))}).then(function(e){if(r.length)a({action:"delete",key:"customerContact",contactDetail:r,id:t[0]._id});else{var c=t;c[0].contactDetail=[],n.setState({contactFields:c})}})},n.createUser=function(){window.location.href="/createnewcustomer"},n.addContact=function(){var e=n.state.contactFields||[];e.push({phone:"",isActive:0}),n.setState({contactFields:e,isFieldUpdated:!1})},n.getContactFields=function(e){var t=n.props,a=t.submitting,c=t.submitContact,o=t.customerContact,i=Object(x.a)(n),u=i.onDelete,l=i.addContact,s=n.state.contactFields,m=[{value:0,text:"deactivate"},{value:1,text:"activate"}],d=s&&s.map(function(e,t){return r.a.createElement(P.a,{key:"field_".concat(t),name:"section_".concat(t)},r.a.createElement("tr",{key:"row_".concat(t)},r.a.createElement("td",{className:"table-column"},r.a.createElement(z.a,{name:"phone",component:re,type:"text",placeholder:"Phone number",maxlength:15,validate:[B,K,X]})),r.a.createElement("td",{className:"table-column"},r.a.createElement(z.a,{name:"isActive",component:ae,data:m,valueField:"value",textField:"text",defaultValue:e.isActive,validate:[Q]})),r.a.createElement("td",{className:"table-column"}," ",r.a.createElement("button",{type:"button",onClick:function(e){return u(t,o,c)}},"Delete")," ")))});return r.a.createElement(r.a.Fragment,null,d,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("button",{type:"button",onClick:l},"Add Number"))),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("button",{type:"submit",disabled:a},"Update"))))},n.handleErrorClick=function(){n.props.handleErrorClick(),n.props.history.push("/")},n.state=n.componentState(),n}return Object(H.a)(t,e),Object(D.a)(t,[{key:"componentDidMount",value:function(){this.props.getCustomer({key:"customerList"})}},{key:"componentDidUpdate",value:function(e,t){var n=this,a={},r=this.props.customerContact;this.state.isFieldUpdated||(r&&r[0]&&r[0].contactDetail&&r[0].contactDetail.forEach(function(e,t){console.log(e,t),a["section_".concat(t,".phone")]=e.phone,a["section_".concat(t,".isActive")]=e.isActive}),Object.keys(a).forEach(function(e){return n.props.change(e,a[e])}),this.setState({isFieldUpdated:!0}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.customerList,a=t.isFetching,c=t.customerContact,o=t.handleSubmit,i=t.deleteSelectedUser,u=t.submitContact,l=t.error;return t.isError&&Object(q.confirmAlert)({title:"Error",message:l||"There is an Error Sorry !!",buttons:[{label:"Ok",onClick:function(){return e.handleErrorClick("Click Yes")}}]}),r.a.createElement(J.a,{active:a,spinner:!0},r.a.createElement(G.a,{name:"add-contact",onSubmit:o(function(t){return e.handleSubmit(t,{customerContact:c,submitContact:u})})},r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement(z.a,{busy:a,busySpinner:r.a.createElement("span",{className:"fas fa-sync fa-spin"}),name:"customerList",component:ae,data:n,valueField:"id",textField:"name",placeholder:"Select Customer",onChange:this.onChange}))),!!c.length&&this.getContactFields(),r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("button",{type:"button",onClick:this.createUser},"Create User"))),c[0]&&r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3"},r.a.createElement("button",{type:"button",onClick:function(e){return i(c[0]._id)}},"Delete Selected User")))||null))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.customerContact[0]&&e.customerContact[0]._id&&e.change("customerList",e.customerContact[0]._id),{contactFields:e.customerContact[0]&&e.customerContact[0].contactDetail}}}]),t}(a.Component),oe=Object(M.a)({form:"ContactForm",enableReinitialize:!0})(ce),ie=Object(l.b)(function(e){return{customerList:e.app.customerList||[],isFetching:e.app.isFetching,customerContact:e.app.customerContact||[],error:e.app.error,isError:e.app.isError}},function(e){return{getCustomer:function(t){return e(S(t))},submitContact:function(t){return e(j(t))},deleteSelectedUser:function(t){return e(F(t))},handleErrorClick:function(t){return e(function(e){e({type:v.CLEAR_ERROR})})}}})(oe),ue=n(141),le=Object(M.a)({form:"newCustomer",enableReinitialize:!0})(function(e){var t=Object(a.useState)(!1),n=Object(ue.a)(t,2),c=n[0],o=n[1];return e.toRedirect||c?r.a.createElement(u.a,{to:"/"}):r.a.createElement(G.a,{name:"newCustomer",onSubmit:e.handleSubmit(e.createNewCustomer)},r.a.createElement("p",{className:"heading"},"Create New User"),r.a.createElement(z.a,{name:"name",component:re,type:"text",placeholder:"Customer Name",validate:[B,$,Y,Z]}),e.touched&&e.error&&r.a.createElement("span",null,e.error),r.a.createElement("p",null,r.a.createElement("button",{type:"Submit"},"Create Customer")),r.a.createElement("p",null,r.a.createElement("button",{type:"button",onClick:function(e){return o(!0)}},"Redirect To Customer Contact Page ")))}),se=Object(l.b)(function(e){return{toRedirect:e.app.isCreatedUser&&e.app.isCreatedUser.ok}},function(e){return{createNewCustomer:function(t){return e(R(t))}}})(le);n(302),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var me=Object(T.c)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.FETCHING_RESULT:return Object(s.a)({},e,{isFetching:!0,isError:!1});case v.SHOW_ERROR:return Object(s.a)({},e,{isFetching:!1,isError:!0,error:t.error});case v.CLEAR_ERROR:return Object(s.a)({},e,{isError:!1,error:null});case v.FETCHED_RESULT:return Object(s.a)({},e,{isFetching:!1,isError:!1},t.payload||[]);case v.RESET_STATE:return Object(s.a)({},e,{isFetching:!1,isError:!1,status:v.QUOTE,resultQuote:{}});default:return Object(s.a)({},e)}},form:_.a}),de=Object(w.createLogger)(),pe=Object(T.d)(me,Object(T.a)(U.a,de)),Ee=function(){return r.a.createElement("strong",null,"Sorry No Page Found")},fe=r.a.createElement(l.a,{store:pe},r.a.createElement(function(){return r.a.createElement(i.a,{basename:"/simple-redux-form"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/createnewcustomer",component:se}),r.a.createElement(u.b,{path:"/",component:ie}),r.a.createElement(u.b,{component:Ee})))},null));o.a.render(fe,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[145,1,2]]]);
//# sourceMappingURL=main.05091072.chunk.js.map